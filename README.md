npm-plugin
==========

*npm-plugin* is a very basic `sbt` plugin to generate and publish Scala.js libraries as `npm` packages at `npmjs.org`. Any `npm` library dependencies that your library has will be handled correctly.

Usage
-----

Add the following lines to your `plugins.sbt`

    resolvers += Resolver.bintrayRepo("edadma", "sbt-plugins")
    addSbtPlugin("xyz.hyperreal" % "npm-plugin" % "0.1.8")
    
Tasks
-----

The plugin provides three tasks

### `npmBuild`

This task builds a valid `npm` package in `target/npm` which it creates if not there. It uses settings from your build settings as well as the `package.json` generated by the compiler.

`npmBuild` assumes that you have executed at least a `run` command, and possibly a `fullOptJS` command, to get the compiler to generate everything needed to build an `npm` package, and that the `name` and `version` settings in your `build.sbt` won't conflict with any existing package on `npmjs.org`.

`npmBuild` will update an existing package if there is a compiler output JavaScript file (either a `-fastopt.js` or `-opt.js` file) that is newer than the `index.js` file in the package. It always takes the newer of the two if there are both `-fastopt.js` or `-opt.js` type files present. The package also gets updated if the `build.sbt` file has changed.

### `npmPack`
This task starts by executing `npmPackage`, and then runs `npm pack` in the same folder where `npmBuild` builds the package. The package tarball is written to `target/npm`.

### `npmPublish`

This task starts by executing `npmPackage`, and then runs `npm publish` in the same folder where `npmBuild` builds the package. The package is then published to `npmjs.org`.

Any package tarballs that might have been created by `npmPack` are first removed before running `npm publish`.
